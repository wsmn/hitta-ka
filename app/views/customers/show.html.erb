<% content_for(:sidebar) do %>
  <%= render('application/account_menu', current: :customers) %>
<% end %>
<% content_for(:header_title) do %>
  <%= t('.title') %>
<% end %>
<div x-data="{ tab: 'projects' }" class="flex flex-col flex-grow bg-white">
  <%= render('show_heading') %>
  <div class="sm:p-4">
    <div class="flex flex-wrap sm:-mx-2">
      <div class="w-full max-w-6xl lg:w-full xl:w-2/3 sm:px-2">
        <div class="overflow-hidden bg-white border-gray-300 sm:border sm:shadow sm:rounded-lg">
          <div class="hidden px-4 py-5 border-b border-gray-200 sm:px-6 sm:block">
            <h3 class="text-lg font-medium leading-6 text-gray-900">
              Customer information
            </h3>
            <p class="max-w-2xl mt-1 text-sm leading-5 text-gray-500">
              Contact and address details.
            </p>
          </div>
          <div class="px-4 py-5 sm:px-6">
            <dl class="grid grid-cols-1 row-gap-8 col-gap-4 sm:grid-cols-2">
              <div class="sm:col-span-1">
                <dt class="text-sm font-medium leading-5 text-gray-500">
                  <%= t('.billing_address') %>
                </dt>
                <dd class="mt-1 text-sm leading-5 text-gray-900">
                  <% if @customer.street.present? | @customer.zip_code.present? | @customer.city.present? %>
                    <% if @customer.street %>
                      <%= @customer.street %>
                    <% end %>
                    <% if @customer.zip_code && @customer.city %>
                      <%= @customer.zip_code %>
                      <p class=""><%= @customer.city %></p>
                    <% elsif @customer.zip_code %>
                      <p class=""><%= @customer.zip_code %></p>
                    <% elsif @customer.city %>
                      <p class=""><%= @customer.city %></p>
                    <% end %>
                  <% else %>
                    N/A
                  <% end %>
                </dd>
              </div>
              <div class="sm:col-span-1">
                <dt class="text-sm font-medium leading-5 text-gray-500">
                  <%= t('.phone') %>
                </dt>
                <dd class="mt-1 text-sm leading-5 text-gray-900">
                  <% if @customer.phone.present? %>
                    <%= @customer.phone %>
                  <% else %>
                    N/A
                  <% end %>
                </dd>
              </div>
              <div class="sm:col-span-1">
                <dt class="text-sm font-medium leading-5 text-gray-500">
                  <%= t('.email') %>
                </dt>
                <dd class="mt-1 text-sm leading-5 text-blue-500">
                  <% if @customer.email.present? %>
                    <%= link_to(@customer.email, "mailto:#{@customer.email}") %>
                  <% else %>
                    <span class="text-gray-900">N/A</span>
                  <% end %>
                </dd>
              </div>
              <div class="sm:col-span-1">
                <dt class="text-sm font-medium leading-5 text-gray-500">
                  <%= t('.custom_task_rate') %>
                </dt>
                <dd class="mt-1 text-sm leading-5 text-gray-900">
                  999,00 SEK
                </dd>
              </div>
              <div class="sm:col-span-2">
                <dt class="text-sm font-medium leading-5 text-gray-500">
                  About
                </dt>
                <dd class="mt-1 text-sm leading-5 text-gray-900">
                  Fugiat ipsum ipsum deserunt culpa aute sint do nostrud anim incididunt cillum culpa consequat.
                  Excepteur
                  qui ipsum aliquip consequat sint. Sit id mollit nulla mollit nostrud in ea officia proident. Irure
                  nostrud
                  pariatur mollit ad adipisicing reprehenderit deserunt qui eu.
                </dd>
              </div>
              <div class="sm:col-span-2">
                <dt class="text-sm font-medium leading-5 text-gray-500">
                  <%= t('.download') %>
                </dt>
                <dd class="mt-1 text-sm leading-5 text-gray-900">
                  <ul class="border border-gray-200 rounded-md">
                    <li class="flex items-center justify-between py-3 pl-3 pr-4 text-sm leading-5">
                      <div class="flex items-center flex-1 w-0">
                        <svg class="flex-shrink-0 w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd"
                            d="M8 4a3 3 0 00-3 3v4a5 5 0 0010 0V7a1 1 0 112 0v4a7 7 0 11-14 0V7a5 5 0 0110 0v4a3 3 0 11-6 0V7a1 1 0 012 0v4a1 1 0 102 0V7a3 3 0 00-3-3z"
                            clip-rule="evenodd" />
                        </svg>
                        <span class="flex-1 w-0 ml-2 truncate">
                          customer_information.pdf
                        </span>
                      </div>
                      <div class="flex-shrink-0 ml-4">
                        <a href="#"
                          class="font-medium text-indigo-600 transition duration-150 ease-in-out hover:text-indigo-500">
                          Download
                        </a>
                      </div>
                    </li>
                  </ul>
                </dd>
              </div>
            </dl>
          </div>
        </div>
      </div>
      <div class="block w-full mt-4 xl:w-1/3 xl:max-w-lg xl:mt-0 sm:px-2">
        <div class="flex flex-grow">
          <div class="flex-grow overflow-hidden bg-white border-gray-300 sm:border sm:shadow sm:rounded-lg">
            <div class="hidden px-4 py-5 border-b border-gray-200 sm:px-6 lg:block">
              <h3 class="text-lg font-medium leading-6 text-gray-900">
                Summary
              </h3>
              <p class="max-w-2xl mt-1 text-sm leading-5 text-gray-500">
                Hours, projects and invoicing overview.
              </p>
            </div>
            <div>
              <dl>
                <div class="grid grid-cols-3 gap-4 px-4 py-5 bg-gray-100 sm:px-6">
                  <dt class="text-sm font-medium leading-5 text-gray-500">
                    Time logged
                  </dt>
                  <dd class="col-span-2 mt-0 text-sm leading-5 text-gray-900">
                    <%= @customer.hours %> h
                  </dd>
                </div>
                <div class="grid grid-cols-3 gap-4 px-4 py-5 bg-white sm:px-6">
                  <dt class="text-sm font-medium leading-5 text-gray-500">
                    Invoiced
                  </dt>
                  <dd class="col-span-2 mt-0 text-sm leading-5 text-gray-900">
                    <%= number_to_currency(@customer.invoiced_total) %>
                    <% if @customer.invoiced_unpaid > 0 %>
                      <span class="text-xs text-red-600">(<%= number_to_currency(@customer.invoiced_unpaid) %>)</span>
                    <% end %>
                  </dd>
                </div>
                <div class="grid grid-cols-3 gap-4 px-4 py-5 bg-gray-100 sm:px-6">
                  <dt class="text-sm font-medium leading-5 text-gray-500">
                    Paid to date
                  </dt>
                  <dd class="col-span-2 text-sm leading-5 text-gray-900">
                    <%= number_to_currency(@customer.invoiced_paid) %>
                  </dd>
                </div>
                <div class="grid grid-cols-3 gap-4 px-4 py-5 bg-white sm:px-6">
                  <dt class="text-sm font-medium leading-5 text-gray-500">
                    Active projects
                  </dt>
                  <dd class="col-span-2 text-sm leading-5 text-gray-900">
                    <%= @customer.projects.active.count %>
                  </dd>
                </div>
                <div class="grid grid-cols-3 gap-4 px-4 py-5 bg-gray-100 sm:px-6">
                  <dt class="text-sm font-medium leading-5 text-gray-500">
                    Total projects
                  </dt>
                  <dd class="col-span-2 text-sm leading-5 text-gray-900">
                    <%= @customer.projects.count %>
                  </dd>
                </div>
                <div class="flex grid items-center grid-cols-3 gap-4 px-4 py-5 bg-white sm:px-6">
                  <dt class="text-sm font-medium leading-5 text-gray-500">
                    Latest project
                  </dt>
                  <dd class="col-span-2 text-sm leading-5 text-gray-900">
                    <ul class="border border-gray-200 rounded-md">
                      <li class="flex items-center justify-between py-3 pl-3 pr-4 text-sm leading-5">
                        <div class="flex items-center flex-1 w-0">
                          <div class="flex items-center justify-center w-6 h-6 bg-blue-500 rounded-full">
                            <svg class="flex-shrink-0 w-4 h-4 text-white" viewBox="0 0 20 20" fill="currentColor">
                              <path
                                d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
                              </svg>
                            </svg>
                          </div>
                          <span class="flex-1 w-0 ml-2 truncate">
                            Project placeholder
                          </span>
                        </div>
                      </li>
                    </ul>
                  </dd>
                </div>
              </dl>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="">
    <div class="px-4 bg-white border-b border-gray-200">
      <nav class="flex justify-between -mb-px sm:justify-start">
        <button button
          :class="{ 'border-indigo-500 text-indigo-700 focus:text-indigo-800 focus:border-indigo-700 hover:border-indigo-700 hover:text-indigo-700': tab === 'projects' }"
          @click="tab = 'projects'"
          class="inline-flex items-center px-1 py-4 text-sm font-medium leading-5 text-gray-500 border-b-2 border-transparent group sm:text-base hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300">
          <svg class="-ml-0.5 mr-2 h-4 w-4 sm:h-5 sm:w-5 group-focus:text-gray-600" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
          </svg>
          <%= t('.projects') %>
        </button>
        <button button
          :class="{ 'border-indigo-500 text-indigo-700 focus:text-indigo-800 focus:border-indigo-700 hover:border-indigo-700 hover:text-indigo-700': tab === 'tasks' }"
          @click="tab = 'tasks'"
          class="inline-flex items-center px-1 py-4 ml-8 text-sm font-medium leading-5 text-gray-500 border-b-2 border-transparent group sm:text-base hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300">
          <svg class="-ml-0.5 mr-2 h-4 w-4 sm:h-5 sm:w-5 group-focus:text-gray-600" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <%= t('.tasks') %>
        </button>
        <button button
          :class="{ 'border-indigo-500 text-indigo-700 focus:text-indigo-800 focus:border-indigo-700 hover:border-indigo-700 hover:text-indigo-700': tab === 'invoices' }"
          @click="tab = 'invoices'"
          class="inline-flex items-center px-1 py-4 ml-8 text-sm font-medium leading-5 text-gray-500 border-b-2 border-transparent group sm:text-base hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300">
          <svg class="-ml-0.5 mr-2 h-4 w-4 sm:h-5 sm:w-5 group-focus:text-gray-600" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
          </svg>
          <%= t('.invoices') %>
        </button>
      </nav>
    </div>
  </div>
  <div x-show="tab === 'projects'" class="flex-grow -mt-px">
    <%= render("projects/table", customer: @customer, projects: @projects, show_filters: false) %>
  </div>
  <div x-show="tab === 'invoices'" class="flex-grow -mt-px">
    <%= render("invoices/table", customer: @customer, invoices: @invoices, show_filters: false) %>
  </div>
  <div x-show="tab === 'tasks'" class="flex-grow -mt-px">
    <%= render('tasks/table', customer: @customer, tasks: @customer.tasks) %>
  </div>
</div>
